---
title: Vim 简单笔记
toc: true
mathjax: false
categories:
  - [笔记]
  - [Linux]
tags:
  - Vim
date: 2021-02-19 15:43:14
---


> 本文总结自 vim 使用向导程序 `vimtutor`

### 前言

1. vim 光标为方块光标，简称“光标”，
   本文将光标方块覆盖字符时的位置称为“光标当前位置”，此时字符称为“当前字符”，
   光标当前位置的左边称为“光标前”，右边则称为“光标后”。

2. vim 中操作按键区分大小写

3. vim 可分为三种模式
   \- 正常模式，启动时进入正常模式，在任何模式按 `Esc` 可回到正常模式
   \- 编辑模式，正常模式下按 `a/A`、`i/I`、`o/O` 可进入编辑模式
   \- 命令行模式，正常模式下按 `:` 可进入命令行模式
   正常模式下可通过单个按键的组合进行操作，在本文中称为命令。
   命令行模式下可运行命令行进行一些更复杂的操作，比如运行外部程序。

### 简单介绍

#### 移动光标
使用 `h`、`j`、`k`、`l` 移动光标
- `h` 位于左边，控制光标左移
- `l` 位于右边，控制光标右移
- `j` 看起来像一个向下的箭头，~~神奇的脑洞~~
- `l` 就剩下向上的方向可以给它了

#### 文本编辑
1. **添加文本**
   | 按键 | 说明 |
   | :- | :- |
   | `a` | 在光标后开始输入 |
   | `A` | 在行尾开始输入 |
   | `i` | 在光标前开始输入 |
   | `I` | 在行首开始输入 |
   | `o` | 在光标下的新的空行开始输入 |
   | `O` | 在光标上的新的空行开始输入 |

2. **删除文本**
   1. 正常模式下可进行简单的删除操作
      例如，按 `x` 可删除当前字符
      还有一些高级点的删除操作，使用了正常模式下的命令操作
   2. 编辑模式下就直接编辑删除就行

#### 保存与退出
- `:w`：保存文件
- `:q`：退出
- `:wq`：保存文件并退出。
- `:q!`：强制退出，不保存更改

#### 查看帮助
遇到不会的就看帮助文档
~~虽然全英~~
- `:help`：查看帮助
- `<F1>`：查看帮助
- `:help [command]`：可显示相关命令帮助

### 普通模式下的命令操作

#### 常用按键命令
1. **删除**
   | 按键 | 说明 |
   | :- | :- |
   | `x` | 删除当前字符 |
   | `d` | 删除命令，需要配合其他按键使用 |
   | `dd` | 删除当前行 |

   注：删除的文本会暂时存入缓存

2. **高级移动**
   | 按键 | 说明 |
   | :- | :- |
   | `w` | 将光标从当前位置移动到下一个单词前 |
   | `e` | 从当前位置移动到单词结尾 |
   | `$` | 从当前位置移动到行尾 |

3. **编辑**
   | 按键 | 说明 |
   | :- | :- |
   | `r` | 替换当前字符 |
   | `R` | 可连续替换多个字符 |
   | `c` | 替换一段文本，需配合其他按键 |
   | `:s` | 替换匹配的字符串，用法见下方介绍 |
   | `p` | 粘贴缓存中的文本 |
   | `u` | 撤销上一个命令操作 |
   | `U` | 撤销对一整行的更改 |
   | `v` | 进入可视模式进行文本选择 |
   | `y` | 复制选择的文本 |

4. **查找**
   查找命令比较复杂，往下看详细点的介绍
   | 按键 | 说明 |
   | :- | :- |
   | `/` | 往后进行字符串查找 |
   | `?` | 往前进行字符串查找 |
   | `n` | 同上一次查找 |
   | `N` | 反向查找上一次查找的字符串 |
   | `%` | 进行匹配括号查找 |

5. **查看与跳转**
   | 按键 | 说明 |
   | :- | :- |
   | `ctrl-G` | 显示光标位置以及文件状态信息 |
   | `G` | 跳转到文件末尾，或指定行 |
   | `gg` | 跳转至文件开头 |
   | `ctrl-O` | 在查找后，跳转到较先(旧)查找到的位置 |
   | `ctrl-I` | 在查找后，跳转到较晚(新)查找到的位置 |
   | `ctrl-w ctrl-w` | 可切换窗口 |

#### 删除类命令
1. **`d` 的使用**
   **方法：`d+[num]+motion`**
   - `d`: 删除操作符
   - `[num]`: 可选，操作重复次数
   - `motion`：操作对象，可以为`w`，`e`，`$`

示例：
- `dw`：将光标位置置于单词第一个字母，可删除一个单词

#### 替换类命令
1. **`c` 的使用**
   **方法：`c+[num]+motion`**

   - `c`: 替换操作符
   - `[num]`: 可选，操作重复次数
   - `motion`：操作对象，可以为`w`，`e`，`$`
     注：`c` 命令可以理解为：使用 `d` 删除了要替换的文本，并自动进入编辑模式

2. **`:s` 的使用**
   **方法：`:s/old/new[/g[c]]`**
   上例中，会将光标所在行的第一个匹配到的`old` 字符串替换为 `new`
   选项 `g` 会使此行中的所有 `old` 替换为 `new`
   选项 `c` 会在替换前要求确认

#### 搜索类命令
1. **`/` 的使用**
   **方法：`/str`**
   输入 `/` 后接字符串，将在光标处开始往后查询匹配的字符串

2. **`？` 的使用**
   **方法：`？str`**
   与 `/` 相似，但与 `/` 的查找方向相反，

3. **`n` 与 `N` 的使用**
   输入 `n` 执行上一次查找
   输入 `N` 往相反方向查找与上一次查找相同的字符串

4. **`%` 的使用**
   将光标移到括号上，按下 `%` 将跳转至匹配的括号
   注：没有移到括号上也可以查找，有一定规则，懒得描述，去试一试就清楚了

#### 跳转类命令
1. **`G` 的使用**
   **方法：`[num]+G`**
   - `[num]`：要跳转至的行数

### 命令行模式简单使用

在正常模式下输入 `:` 即可进入命令行模式

#### 对vim进行设置
使用`:set [setting]`，可设置相关项，一些有用的选项如下
- `ic`：查找时忽略字母大小写
- `is`：查找短语时显示部分匹配
- `hls`：高亮显示所有匹配部分
在选项前加上 `no` 可关闭选项，如 `noic` 可关闭忽略大小写

#### 运行外部命令
在正常模式下输入 `:!`，紧接着输入外部命令即可
例如：`:!ls` 将列出目录下的文件

#### 切换至外部 shell
使用`：shell`可以切换到命令行窗口
在命令行窗口退出会回到 vim

#### 多窗口
1. 打开多窗口
   横行切分窗口
   - `:new [file]`：`[file]` 是打开的文件，若不是存在的文件则在保存后会创建文件
   - `:split [file]`：同上，可简写为 `:sp [file]`
   纵向切分窗口
   - `:vsplit [file]`：同上，窗口切分方式不同

2. 关闭多窗口
   可使用普通窗口的保存与退出的方式，或者以下命令
   - `:close`：关闭窗口，但文件存在缓存中，使用 `:q!` 才算真正退出
   - `:tabc`：关闭当前窗口
   - `:tabo`：关闭所有窗口

3. 切换窗口
   首先按下 `ctrl-w`，后按：
   - `j`：切换到下一个窗口
   - `k`：切换到上一个窗口
   - `ctrl-w`：依次切换

4. 更改大小
   - 横向调整
      - `ctrl-w +`：扩大窗口
      - `ctrl-w -`：减小窗口
      - `:resize [num]`：将窗口更改为 `[num]` 行
      - `:resize+[num]`：将窗口大小增加 `[num]` 行
      - `:resize-[num]`：将窗口大小减少 `[num]` 行
   - 纵向调整
      - `:vertical resize [num]`：将窗口更改为 `[num]` 列
      - `:vertical resize+[num]`：将窗口大小增加 `[num]` 列
      - `:vertical resize-[num]`：将窗口大小减少 `[num]` 列

5. 窗口重命名
   - `:f [newname]`：`[newname]` 为窗口新名字

6. 打开多文件
   在shell中打开文件时，使用 `vim a b c`
   - `:n`：跳至下一文件
   - `:n c`：跳至 `文件c`
   - `:e#`：返回上一个编辑的文件

7. 文件浏览
   - `:Ex`：开启目录浏览器
   - `:ls`：显示当前缓存情况

8. 临时切换到shell
   - `:shell`：切换到shell，退出shell即可回到vim
